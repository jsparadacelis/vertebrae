<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vertebrae Segmentation</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Vertebrae Segmentation Tool</h1>
            <p class="subtitle">AI-powered medical image analysis for T1-T12 and L1-L5 vertebrae</p>
        </header>

        <main>
            <!-- API Status -->
            <div class="status-card" id="statusCard">
                <div class="status-indicator">
                    <span class="status-dot" id="statusDot"></span>
                    <span id="statusText">Checking API status...</span>
                </div>
            </div>

            <!-- Model Selection -->
            <div class="card">
                <h2>Configuration</h2>
                <div class="form-group">
                    <label for="modelSelect">Select Model:</label>
                    <select id="modelSelect" class="model-select">
                        <option value="yolo">YOLO</option>
                        <option value="maskrcnn">Mask R-CNN</option>
                    </select>
                    <button id="modelInfoBtn" class="btn-secondary">Model Info</button>
                </div>
            </div>

            <!-- Upload Section -->
            <div class="card">
                <h2>Upload Image</h2>
                <div class="upload-zone" id="uploadZone">
                    <input type="file" id="fileInput" accept="image/*" hidden>
                    <div class="upload-content">
                        <svg class="upload-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                        </svg>
                        <p class="upload-text">Drag and drop an image here</p>
                        <p class="upload-subtext">or</p>
                        <button class="btn-primary" id="browseBtn">Browse Files</button>
                        <p class="upload-hint">Supported formats: JPEG, PNG</p>
                    </div>
                </div>

                <!-- Preview Section -->
                <div class="preview-section" id="previewSection" style="display: none;">
                    <h3>Original Image</h3>
                    <img id="previewImage" class="preview-image" alt="Preview">
                    <button class="btn-danger" id="clearBtn">Clear Image</button>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="card actions" id="actionsCard" style="display: none;">
                <button class="btn-primary btn-large" id="analyzeBtn">
                    <span id="analyzeBtnText">Analyze Image</span>
                </button>
                <button class="btn-secondary btn-large" id="visualizeBtn">
                    <span id="visualizeBtnText">Get Annotated Image</span>
                </button>
            </div>

            <!-- Results Section -->
            <div class="card" id="resultsCard" style="display: none;">
                <h2>Results</h2>
                <div class="results-meta">
                    <div class="meta-item">
                        <span class="meta-label">Detections:</span>
                        <span class="meta-value" id="numDetections">-</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Processing Time:</span>
                        <span class="meta-value" id="processingTime">-</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Model Used:</span>
                        <span class="meta-value" id="modelUsed">-</span>
                    </div>
                </div>

                <!-- Detections Table -->
                <div class="table-container">
                    <table class="detections-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Vertebra</th>
                                <th>Confidence</th>
                                <th>Bounding Box</th>
                            </tr>
                        </thead>
                        <tbody id="detectionsTableBody">
                        </tbody>
                    </table>
                </div>

                <!-- Annotated Image -->
                <div id="annotatedSection" style="display: none;">
                    <h3>Annotated Image</h3>
                    <img id="annotatedImage" class="preview-image" alt="Annotated">
                    <button class="btn-secondary" id="downloadBtn">Download Image</button>
                </div>
            </div>

            <!-- Model Info Modal -->
            <div id="modelInfoModal" class="modal">
                <div class="modal-content">
                    <span class="close">&times;</span>
                    <h2>Model Information</h2>
                    <div id="modelInfoContent" class="model-info-content">
                        <p>Loading...</p>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <p>Vertebrae Segmentation API v0.2.0</p>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>
